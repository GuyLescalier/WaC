<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Configurator.Views.HeaderView"
             x:Name="this">

    <ContentView.Resources>
        <!-- Les styles sont nécessaires ici aussi s'ils sont utilisés dans ce composant -->
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="CornerRadius" Value="0" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="TextColor" Value="White" />
            <Setter Property="HeightRequest" Value="32" />
            <Setter Property="VisualStateManager.VisualStateGroups">
                <VisualStateGroupList>
                    <VisualStateGroup x:Name="CommonStates">
                        <VisualState x:Name="Normal">
                            <VisualState.Setters>
                                <Setter Property="BackgroundColor" Value="#007ACC" />
                                <Setter Property="Opacity" Value="1" />
                            </VisualState.Setters>
                        </VisualState>
                        <VisualState x:Name="Disabled">
                            <VisualState.Setters>
                                <Setter Property="BackgroundColor" Value="#3A3A3A" />
                                <Setter Property="TextColor" Value="#9A9A9A" />
                                <Setter Property="Opacity" Value="0.6" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateGroupList>
            </Setter>
        </Style>

        <Style x:Key="SuccessButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButtonStyle}">
            <Setter Property="VisualStateManager.VisualStateGroups">
                <VisualStateGroupList>
                    <VisualStateGroup x:Name="CommonStates">
                        <VisualState x:Name="Normal">
                            <VisualState.Setters>
                                <Setter Property="BackgroundColor" Value="#16825D" />
                                <Setter Property="TextColor" Value="White" />
                                <Setter Property="Opacity" Value="1" />
                            </VisualState.Setters>
                        </VisualState>
                        <VisualState x:Name="Disabled">
                            <VisualState.Setters>
                                <Setter Property="BackgroundColor" Value="#3A3A3A" />
                                <Setter Property="TextColor" Value="#9A9A9A" />
                                <Setter Property="Opacity" Value="0.6" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateGroupList>
            </Setter>
        </Style>
    </ContentView.Resources>

    <!-- HEADER : Titre + Actions -->
    <Border BackgroundColor="#2D2D30" Stroke="#3E3E42" StrokeThickness="1">
        <Grid RowDefinitions="40,Auto">
            <!-- Row 0: Titre -->
            <Border Grid.Row="0" BackgroundColor="#3E3E42" Stroke="#525252" StrokeThickness="0">
                <Grid ColumnDefinitions="Auto,*" Padding="12,0">
                    <Label Grid.Column="0" Text="DSC Configuration Manager" FontSize="15" FontAttributes="Bold" TextColor="#FFFFFF" VerticalOptions="Center"/>
                    <BoxView Grid.Column="1" HeightRequest="1" VerticalOptions="End" Margin="12,0,0,0" BackgroundColor="#4A4A4A" />
                </Grid>
            </Border>
            <!-- Row 1: Actions -->
            <Grid Grid.Row="1" Padding="12" ColumnDefinitions="Auto,8,*,12,Auto,8,Auto" ColumnSpacing="0">
                <!-- Bouton 'Open file…' -->
                <Border Grid.Column="0" BackgroundColor="#383838" Stroke="#484848" StrokeThickness="1">
                    <Grid ColumnDefinitions="4,Auto" HeightRequest="34">
                        <BoxView Grid.Column="0" BackgroundColor="#007ACC" VerticalOptions="Fill"/>
                        <Button Grid.Column="1" Text="📁  Open file…" Clicked="OnOpenFileClicked" BackgroundColor="Transparent" TextColor="#D4D4D4" FontAttributes="Bold" FontSize="13" Padding="12,0" CornerRadius="0" HeightRequest="34"/>
                    </Grid>
                </Border>
                <!-- Badge: fichier sélectionné -->
                <Border Grid.Column="2" BackgroundColor="#303030" Stroke="#484848" StrokeThickness="1" Padding="10,6" HeightRequest="34" VerticalOptions="Center">
                    <Grid ColumnDefinitions="Auto,6,*">
                        <Label Grid.Column="0" Text="File:" TextColor="#9E9E9E" FontSize="11" VerticalOptions="Center"/>
                        <Label Grid.Column="2" Text="{Binding Source={x:Reference this}, Path=SelectedFileDisplay}" TextColor="#D4D4D4" FontSize="12" LineBreakMode="TailTruncation" VerticalOptions="Center"/>
                    </Grid>
                </Border>
                <!-- TEST ALL -->
                <Button Grid.Column="4" Style="{StaticResource PrimaryButtonStyle}" Text="TEST ALL" Clicked="OnRunFullConfigTestClicked" IsEnabled="{Binding Source={x:Reference this}, Path=IsConfigFileSelected}" WidthRequest="110" HeightRequest="34"/>
                <!-- APPLY ALL -->
                <Button Grid.Column="6" Style="{StaticResource SuccessButtonStyle}" Text="APPLY ALL CHANGES" Clicked="OnApplyAllChangesClicked" IsEnabled="{Binding Source={x:Reference this}, Path=IsApplyAllEnabled}" WidthRequest="170" HeightRequest="34"/>
            </Grid>
        </Grid>
    </Border>
</ContentView>
